{% load static %}

<div class="container mt-5">

  {% if category %}
    <!-- 背景写真 + タイトル -->
    <div class="position-relative text-center mb-5">

      {% if category.slug == "washoku" %}
        <img src="{% static 'img/item_detail/washoku.png' %}" class="img-fluid w-100 rounded shadow" alt="{{ category.name }}">
      {% elif category.slug == "udon" %}
        <img src="{% static 'img/item_detail/udon.jpg' %}" class="img-fluid w-100 rounded shadow" alt="{{ category.name }}">
      {% elif category.slug == "donburi" %}
        <img src="{% static 'img/item_detail/donburi.jpg' %}" class="img-fluid w-100 rounded shadow" alt="{{ category.name }}">
      {% elif category.slug == "ramen" %}
        <img src="{% static 'img/item_detail/ramen.webp' %}" class="img-fluid w-100 rounded shadow" alt="{{ category.name }}">
      {% elif category.slug == "oden" %}
        <img src="{% static 'img/item_detail/oden.jpg' %}" class="img-fluid w-100 rounded shadow" alt="{{ category.name }}">
      {% elif category.slug == "agemono" %}
        <img src="{% static 'img/item_detail/agemono.jpg' %}" class="img-fluid w-100 rounded shadow" alt="{{ category.name }}">
      {% elif category.slug == "izakaya" %}
        <img src="{% static 'img/item_detail/izakaya.webp' %}" class="img-fluid w-100 rounded shadow" alt="{{ category.name }}">
      {% elif category.slug == "yakiniku" %}
        <img src="{% static 'img/item_detail/yakiniku.webp' %}" class="img-fluid w-100 rounded shadow" alt="{{ category.name }}">
      {% elif category.slug == "kare" %}
        <img src="{% static 'img/item_detail/kare.jpeg' %}" class="img-fluid w-100 rounded shadow" alt="{{ category.name }}">
      {% elif category.slug == "tyuka" %}
        <img src="{% static 'img/item_detail/tyuka.png' %}" class="img-fluid w-100 rounded shadow" alt="{{ category.name }}">
      {% elif category.slug == "hanberga" %}
        <img src="{% static 'img/item_detail/hanbaga.jpeg' %}" class="img-fluid w-100 rounded shadow" alt="{{ category.name }}">
      {% elif category.slug == "soba" %}
        <img src="{% static 'img/item_detail/soba.jpg' %}" class="img-fluid w-100 rounded shadow" alt="{{ category.name }}">
      {% elif category.slug == "okonomi" %}
        <img src="{% static 'img/item_detail/okonomi.jpg' %}" class="img-fluid w-100 rounded shadow" alt="{{ category.name }}">
      {% elif category.slug == "takoyaki" %}
        <img src="{% static 'img/item_detail/takoyaki.jpg' %}" class="img-fluid w-100 rounded shadow" alt="{{ category.name }}">
      {% elif category.slug == "yakitori" %}
        <img src="{% static 'img/item_detail/yakitori.webp' %}" class="img-fluid w-100 rounded shadow" alt="{{ category.name }}">
      {% elif category.slug == "sukiyaki" %}
        <img src="{% static 'img/item_detail/sukiyaki.jpg' %}" class="img-fluid w-100 rounded shadow" alt="{{ category.name }}">
      {% elif category.slug == "tenpura" %}
        <img src="{% static 'img/item_detail/tenpura.jpg' %}" class="img-fluid w-100 rounded shadow" alt="{{ category.name }}">
      {% endif %}

      <!-- タイトルを中央に重ねる -->
      <h2 class="position-absolute top-50 start-50 translate-middle text-white fw-bold"
          style="font-size: 2.5rem; text-shadow: 2px 2px 6px rgba(0,0,0,0.7);">
        {{ category.name }}が食べたいお店一覧
      </h2>
    </div>
  {% else %}
    <h2 class="mb-4" style="font-size: 2rem;">お店一覧</h2>
  {% endif %}

  {% if items %}
    <div class="row">
      {% for item in items %}
        <div class="col-lg-3 col-md-4 col-sm-6 mb-4">
          <div class="card h-100 shadow-sm border-0 text-center">

            <!-- 写真 -->
            {% if item.image and item.image.name %}
              <img src="{{ item.image.url }}" 
                   class="card-img-top mx-auto d-block" 
                   style="width:50%; height:auto;" 
                   alt="{{ item.name }}">
            {% else %}
              <img src="{% static 'img/category/shop.jpg' %}" 
                   class="card-img-top mx-auto d-block" 
                   style="width:50%; height:auto;" 
                   alt="{{ item.name }}">
            {% endif %}

            <!-- 店舗情報 -->
            <div class="card-body">
              <h5 class="card-title" style="font-size: 2rem;">
                <a href="{% url 'item_detail' item.id %}" class="text-dark font-weight-bold">
                  {{ item.name }}
                </a>
              </h5>

              <p class="card-text mb-1 text-muted" style="font-size: 1.5rem;">
                カテゴリー: {{ item.category.name|default:"カテゴリー不明" }}
              </p>

              <p class="mb-0" style="font-size: 1.5rem;">
                平均評価: ⭐️ {% if item.avg_rating %} {{ item.avg_rating|floatformat:1 }} / 5 {% else %} - {% endif %}
              </p>
            </div>
          </div>
        </div>
      {% endfor %}
    </div>
  {% else %}
    <p style="font-size: 1.5rem;">お店はまだ登録されていません。</p>
  {% endif %}
</div>
